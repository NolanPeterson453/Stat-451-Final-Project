data.frame(Feature = 0) %>%
pivot_longer(cols = everything(), names_to = Feature)
## Create plot of counts of unreported in each feature
soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing)
## Create plot of counts of unreported in each feature
soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
## Create plot of counts of unreported in each feature
soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0) %>%
select(-c(FFNSQ_F, FFNSQ))
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
View(missing_tab)
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)[-c(29,31),]
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)[-c(29,31),]
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
missing_tab <- missing_tab[-c(29,31),]
View(missing_tab)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing),
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 4),
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
View(missing_tab)
missing_tab <- missing_tab[-c(29,31,5),]
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 4),
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
ylab = "Percent of Observations Not Reported",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
ylab = "Percent of Observations Not Reported",
color = "green",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Guide Importance Scores",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
not_rep <- ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 18,
height = 24,
units = "in",
dpi = 300,
limitsize = TRUE,
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 2499,
height = 3332,
units = "px",
dpi = 300,
limitsize = TRUE,
)
missing_tab <- missing_tab[-c(29,31,5),] %>% filter(Missing >= 1)
not_rep <- ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 2499,
height = 3332,
units = "px",
dpi = 300,
limitsize = TRUE,
)
View(not_rep)
ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
not_rep <- ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 2499,
height = 3332,
units = "px",
dpi = 300,
limitsize = TRUE,
)
missing_tab <- missing_tab[-c(29,31,5),] %>% filter(Missing >= 0.01)
not_rep <- ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 2499,
height = 3332,
units = "px",
dpi = 300,
limitsize = TRUE,
)
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
View(missing_tab)
missing_tab <- missing_tab[-c(29,31,5),] %>% filter(Missing >= 0.001)
## Create plot of counts of unreported in each feature
missing_tab <- soc_data %>%
lapply( function(x){ length(which(x==0))/length(x)}) %>%
data.frame() %>%
gather(key = Features, Missing) %>%
filter(Missing != 0)
missing_tab <- missing_tab[-c(29,31,5),] %>% filter(Missing > 0.01)
not_rep <- ggpubr::ggdotchart(missing_tab, x = "Features", y = "Missing",
main = "Not Reported in Features",
ylab = "Percent of Observations Not Reported",
color = "seagreen",
sorting = "descending",                    # Sort value in descending order
add = "segments",                             # Add segments from y = 0 to dots
rotate = TRUE,                                # Rotate vertically
# Order by groups
dot.size = 6,                                 # Large dot size
label = round(missing_tab$Missing, 3) * 100,
font.label = list(color = "white", size = 7,
vjust = 0.5),               # Adjust label parameters
ggtheme = ggplot2::theme_bw()                         # ggplot2 theme
)
ggplot2::ggsave(
file = "Not Reported.png",
plot = not_rep,
scale = 1,
width = 2499,
height = 3332,
units = "px",
dpi = 300,
limitsize = TRUE,
)
## Response distribution
ggplot(soc_data, aes( x = FSLPR)) + geom_density()
## Response distribution
ggplot(soc_data, ) + geom_density(aes(x = FSLPR)) + geom_density(aes(x = FSLPR))
## Response distribution
ggplot(soc_data, ) + geom_density(aes(x = FSLPR)) + geom_density(aes(x = FSQFS))
sum(FSLPR * (WEIGHT / sum(WEIGHT)))
sum(soc_data$FSLPR * (soc_data$WEIGHT / sum(soc_data$WEIGHT)))
median(soc_data$FSLPR)
install.packages("ENmisc")
install.packages('splitstackshape')
library(splitstackshape)
weighted_soc_data <- expandRows(soc_data, WEIGHT)
weighted_soc_data <- expandRows(soc_data, Vsoc_data$WEIGHT)
weighted_soc_data <- expandRows(soc_data, soc_data$WEIGHT)
weighted_soc_data <- expandRows(soc_data, count = soc_data$WEIGHT)
weights <- as.numeric(soc_data$WEIGHT)
weighted_soc_data <- expandRows(soc_data, count = weights)
weighted_soc_data <- expandRows(soc_data, count = WEIGHT)
View(soc_data)
weighted_soc_data <- expandRows(soc_data, count = 31)
## home price by region
FSLPR_REGION <- ggplot(data = weighted_soc_data, aes(y = FSLPR,
x = as.factor(DIV),
color = as.factor(DIV))) +
geom_boxplot() +
labs(y = "Sale Price of Home",
x = "Region of Home",
color = "Region of Home") +
scale_color_manual(values = c(1:9), labels = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific"))
FSLPR_REGION
## Heating fuel as a proxy for LOTV
ggplot(data = wieghted_soc_data, aes(y = LOTV,
x = as.factor(FUEL),
color = as.factor(FUEL))) +
geom_boxplot() +
labs(y = "Lot Value",
x = "Heating Fuel Type",
color = "Heating Fuel Type") +
scale_color_manual(values = c(1:6), labels = c("01 = Electricity",
"02 = Natural gas",
"03 = Bottled or liquefied
petroleum gas (including propane)",
"04 = Oil
(including heating oil or kerosene)",
"05 = Other or no heat",
"00 = Not reported"))
## Heating fuel as a proxy for LOTV
ggplot(data = weighted_soc_data, aes(y = LOTV,
x = as.factor(FUEL),
color = as.factor(FUEL))) +
geom_boxplot() +
labs(y = "Lot Value",
x = "Heating Fuel Type",
color = "Heating Fuel Type") +
scale_color_manual(values = c(1:6), labels = c("01 = Electricity",
"02 = Natural gas",
"03 = Bottled or liquefied
petroleum gas (including propane)",
"04 = Oil
(including heating oil or kerosene)",
"05 = Other or no heat",
"00 = Not reported"))
ggplot(data = weighted_soc_data, aes(x = as.factor(DECK), y = FSLPR)) +
geom_boxplot()
ggplot(data = weighted_soc_data, aes(x = AREA, y = FSLPR, color = as.factor(DIV))) +
geom_point() + labs(y = "Sale Price of Home",
x = "Lot Size",
color = "Region of Home") +
scale_color_manual(values = my_color, labels = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific"))
## LOT AREA vs SALE PRICE with DIV as confounding feature
my_color <- c(ggsci::pal_npg("nrc")(9), ggsci::pal_lancet("lanonc")(9))
ggplot(data = weighted_soc_data, aes(x = AREA, y = FSLPR, color = as.factor(DIV))) +
geom_point() + labs(y = "Sale Price of Home",
x = "Lot Size",
color = "Region of Home") +
scale_color_manual(values = my_color, labels = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific"))
## Looking at averages
weighted_soc_data %>% group_by(DIV) %>%
summarise(avg_price = mean(FSLPR),
avg_area = mean(AREA)) %>%
ggplot(aes(x = avg_area, y = avg_price, color = as.factor(DIV), label = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific"))) +
geom_point() + labs(y = "Average Sale Price of Home",
x = "Average Lot Size",
color = "Region of Home") +
scale_color_manual(values = my_color, labels = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific")) +
ggrepel::geom_text_repel()
## Weighted Mean and un-weighted median
mean(weighted_soc_data$FSLPR)
median((weighted_soc_data$FSLPR)
median(weighted_soc_data$FSLPR)
median(weighted_soc_data$FSLPR)
## home price by region
FSLPR_REGION <- ggplot(data = weighted_soc_data, aes(y = FSLPR,
x = as.factor(DIV),
color = as.factor(DIV))) +
geom_boxplot() +
labs(y = "Sale Price of Home",
x = "Region of Home",
color = "Region of Home") +
scale_color_manual(values = my_color, labels = c("New England",
"Middle Atlantic",
"East North Central",
"West North Central",
"South Atlantic",
"East South Central",
"West South Central",
"Mountain",
"Pacific"))
FSLPR_REGION
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR)) + geom_bar(stat = "idenity")
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR)) + geom_bar(stat = "identity")
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR)) + geom_bar(aes(x = FSLPR, stat = "identity"))
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR)) + geom_bar(aes(x = FSLPR), stat = "identity"))
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR))
## Response distribution
ggplot(weighted_soc_data, ) + geom_density(aes(x = FSLPR, color = as.factor(DIV)))
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density(fill = "seagreen")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density(fill = "#FF6666")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density(fill = "#FF6666") +
geom_vline( aes(xintercept=mean(FSLPR), color="seagreen"),
linetype="dashed")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density() +
geom_vline( aes(xintercept=mean(FSLPR), color="Mean Sale Price"),
linetype="dashed")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density() +
geom_vline( aes(xintercept=mean(FSLPR), color="Mean Sale Price"),
linetype="dashed")+
geom_vline( aes(xintercept=median(FSLPR), color="Median Sale Price"),
linetype="dashed")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR, color = "blue")) + geom_density() +
geom_vline( aes(xintercept=mean(FSLPR), color="Mean Sale Price"),
linetype="dashed")+
geom_vline( aes(xintercept=median(FSLPR), color="Median Sale Price"),
linetype="dashed")
## Response distribution
ggplot(weighted_soc_data, aes(x = FSLPR)) + geom_density() +
geom_vline( aes(xintercept=mean(FSLPR), color="Mean Sale Price"),
linetype="dashed")+
geom_vline( aes(xintercept=median(FSLPR), color="Median Sale Price"),
linetype="dashed")
